!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=3)}([function(module,exports,__webpack_require__){__webpack_require__(2)},function(module,exports){!function(){"use strict";function resolveDefs(c,block,def){return("string"==typeof block?block:block.toString()).replace(c.define||skip,function(m,code,assign,value){return 0===code.indexOf("def.")&&(code=code.substring(4)),code in def||(":"===assign?(c.defineParams&&value.replace(c.defineParams,function(m,param,v){def[code]={arg:param,text:v}}),code in def||(def[code]=value)):new Function("def","def['"+code+"']="+value)(def)),""}).replace(c.use||skip,function(m,code){c.useParams&&(code=code.replace(c.useParams,function(m,s,d,param){if(def[d]&&def[d].arg&&param){var rw=(d+":"+param).replace(/'|\\/g,"_");return def.__exp=def.__exp||{},def.__exp[rw]=def[d].text.replace(new RegExp("(^|[^\\w$])"+def[d].arg+"([^\\w$])","g"),"$1"+param+"$2"),s+"def.__exp['"+rw+"']"}}));var v=new Function("def","return "+code)(def);return v?resolveDefs(c,v,def):v})}function unescape(code){return code.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var _globals,doT={name:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};doT.encodeHTMLSource=function(doNotSkipEncoded){var encodeHTMLRules={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},matchHTML=doNotSkipEncoded?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(code){return code?code.toString().replace(matchHTML,function(m){return encodeHTMLRules[m]||m}):""}},_globals=function(){return this||(0,eval)("this")}(),void 0!==module&&module.exports?module.exports=doT:"function"==typeof define&&define.amd?define(function(){return doT}):_globals.doT=doT;var startend={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},skip=/$^/;doT.template=function(tmpl,c,def){c=c||doT.templateSettings;var needhtmlencode,indv,cse=c.append?startend.append:startend.split,sid=0,str=c.use||c.define?resolveDefs(c,tmpl,def||{}):tmpl;str=("var out='"+(c.strip?str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):str).replace(/'|\\/g,"\\$&").replace(c.interpolate||skip,function(m,code){return cse.start+unescape(code)+cse.end}).replace(c.encode||skip,function(m,code){return needhtmlencode=!0,cse.startencode+unescape(code)+cse.end}).replace(c.conditional||skip,function(m,elsecase,code){return elsecase?code?"';}else if("+unescape(code)+"){out+='":"';}else{out+='":code?"';if("+unescape(code)+"){out+='":"';}out+='"}).replace(c.iterate||skip,function(m,iterate,vname,iname){return iterate?(sid+=1,indv=iname||"i"+sid,iterate=unescape(iterate),"';var arr"+sid+"="+iterate+";if(arr"+sid+"){var "+vname+","+indv+"=-1,l"+sid+"=arr"+sid+".length-1;while("+indv+"<l"+sid+"){"+vname+"=arr"+sid+"["+indv+"+=1];out+='"):"';} } out+='"}).replace(c.evaluate||skip,function(m,code){return"';"+unescape(code)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),needhtmlencode&&(c.selfcontained||!_globals||_globals._encodeHTML||(_globals._encodeHTML=doT.encodeHTMLSource(c.doNotSkipEncoded)),str="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+doT.encodeHTMLSource.toString()+"("+(c.doNotSkipEncoded||"")+"));"+str);try{return new Function(c.varname,str)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+str),e}},doT.compile=function(tmpl,def){return doT.template(tmpl,null,def)}}()},function(module,exports,__webpack_require__){window.doT=__webpack_require__(1),function(){var isNotify={};Xiaomi.prototype.buyWay=function(btnObj,options){function Buy(btn){this.outOfStock=function(gid){btn.enableClass("J_openNotifyPop",options.text.notify),btn.attr("data-gid",gid)},this.bespeak=function(){btn.enableUrl(options.bespeakUrl,options.text.bespeak)},this.bespeakBuy=function(cid){btn.enableUrl(options.bespeakUrl,options.text.buy)},this.addToCart=function(cid){btn.enableUrl(xiaomi.globalConfig.orderSite+"/cart/add/"+cid,options.text.buy)},this.selectPacket=function(cid){btn.enableUrl(xiaomi.globalConfig.orderSite+"/event/selectPacket/goodsId/"+cid,options.text.buy)},this.presale=function(gid){btn.enableClass("J_openPresalePop",options.text.buy),$(".J_presalePop").attr("data-gid",gid)},this.colorChoose=function(text){btn.enableClass("J_openColorPop",text)},this.beforeFlashSale=function(){btn.enableUrl(options.bespeakUrl,options.text.beforeFlashSale)},this.damiao=function(gid,hasPacket,hasRecommend){btn.enableUrl("#",options.text.buy).on("click.buy",function(){xiaomi.cart().addGood(gid,function(){window.location.href=hasRecommend?xiaomi.globalConfig.orderSite+"/cart/recommend?phone="+options.productType+"&goodsId="+gid:xiaomi.globalConfig.orderSite+"/cart"})})},this.switchStatusCode=function(data){var _t=this;switch(data.status){case 2:_t.bespeak();break;case 3:case 13:_t.beforeFlashSale();break;case 4:case 14:data.is_cos?_t.outOfStock(data.id):_t.bespeakBuy()}}}function checkStatusCode(statusCode){var statusCodeArray=[2,3,4,13,14];return-1!==$.inArray(statusCode,statusCodeArray)}function changeBuyBtn(buyObj,data){if(data&&data.length>0){for(var statusNum=0,allCos=!0,hasPresale=!1,hasBespoke=!1,firstStatusPro=[],firstStatusStockPro=null,i=0;i<data.length;i++){var flag=!1;data[i].needSubscribe&&(hasBespoke=!0),data[i].is_presale&&!data[i].presale_cos&&(hasPresale=!0),checkStatusCode(data[i].status)&&(!0,statusNum++,1==statusNum&&(firstStatusPro=data[i]),flag||data[i].is_cos||(firstStatusStockPro=data[i],flag=!0)),data[i].is_cos||(allCos=!1,checkStatusCode(data[i].status)||!0)}return statusNum==data.length?void(firstStatusStockPro?buyObj.switchStatusCode(firstStatusStockPro):buyObj.switchStatusCode(firstStatusPro)):data.length>1?void(allCos&&!hasPresale?buyObj.colorChoose(options.text.notify):buyObj.colorChoose(options.text.buy)):data[0].is_presale&&!data[0].presale_cos?void buyObj.presale(data[0].id):data[0].is_cos&&0==statusNum?void(hasBespoke?buyObj.bespeak():buyObj.outOfStock(data[0].id)):data[0].needSubscribe?void buyObj.bespeakBuy():data[0].is_bigtap?(-1==$.inArray(parseInt(data[0].id),xiaomi.globalConfig.damiaoGoodsId)&&xiaomi.globalConfig.damiaoGoodsId.push(parseInt(data[0].id)),void buyObj.damiao(data[0].id,data[0].has_packet,data[0].has_recommend)):void buyObj.addToCart(data[0].id)}buyObj.outOfStock(data[0].id)}function pushTagsForGTM(data){var productInfor=[];if(!(data.length<=0)){for(var i=0;i<data.length;i++){var itemInformartion={id:data[i].sku,name:data[i].name,price:data[i].price};productInfor.push(itemInformartion)}dataLayer.push({ecommerce:{detail:{actionField:{list:"Arraytitle"},products:productInfor}}})}}function pushTagsForPixel(data){if(!(data.length<=0)){for(var price=data[0].price,sku=data[0].sku,i=0;i<data.length;i++)data[i].price<price&&(price=data[i].price,sku=data[i].sku);"undefined"!=typeof fbq&&fbq("track","ViewContent",{content_type:"product",content_ids:sku,value:price,currency:"EUR"})}}function writePrice(data){function formatPrice(number,sign){!sign&&(sign=","),"es"===GLOBAL_CONFIG.appLocal.name&&(sign=".");var parts=number.toString().split(".");return parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,sign),"es"===GLOBAL_CONFIG.appLocal.name?1===parts.length||parts[parts.length-1]>=10?parts.join(","):parts.join(",")+"0":parts.join(".")}function getPrice(data){var proNum=data.length,price=data[0].price,oriPrice=data[0].market_price,dollorSign='<span class="xm-dollor-sign">'+data[0].currency+" </span>",fromTemplate=$("#fromDocuments"),from='<span class="xm-from">From </span>';if(fromTemplate.length>0){var htmlFrom=fromTemplate.html();from=doT.template(htmlFrom)("")}var html="";if("es"===GLOBAL_CONFIG.appLocal.name&&(from='<span class="xm-from">Desde </span>'),proNum>1){var priceArr=[];if(["es","fr","it","de","ru"].indexOf(GLOBAL_CONFIG.appLocal.name)>-1){for(var priceNumArr=[],i=0;i<data.length;i++)if(-1==$.inArray(data[i].price_num,priceNumArr)){var obj={};obj.price=data[i].price,obj.price_num=data[i].price_num,priceNumArr.push(data[i].price_num),priceArr.push(obj)}priceArr=priceArr.sort(function(a,b){return a.price_num-b.price_num})}else{for(var i=0;i<data.length;i++)-1==$.inArray(data[i].price,priceArr)&&priceArr.push(data[i].price);priceArr=priceArr.sort(function(a,b){return a-b})}return priceArr.length>1?html=["es","fr","it","de","ru"].indexOf(GLOBAL_CONFIG.appLocal.name)>-1?from+'<span class="xm-price">'+priceArr[0].price+"</span> "+dollorSign:from+dollorSign+'<span class="xm-price">'+formatPrice(priceArr[0])+"</span>":getPrice([data[0]])}return["es","fr","it","de","ru"].indexOf(GLOBAL_CONFIG.appLocal.name)>-1?(html+='<span class="xm-price">'+price+"</span> "+dollorSign,price!=oriPrice&&(html+=' <span class="xm-ori-price"><del>'+oriPrice+" "+dollorSign+"</del></span>")):(html+=dollorSign+'<span class="xm-price">'+formatPrice(price)+"</span>",price!=oriPrice&&(html+=' <span class="xm-ori-price"><del>'+dollorSign+formatPrice(oriPrice)+"</del></span>")),html}!function(){!data||data.length<=0||$price.each(function(index,val){var $ele=$(val),actualData=data;if($ele.attr("data-gids")){for(var ids=$ele.attr("data-gids").split(","),dataPart=[],i=0;i<ids.length;i++){var pro=$.grep(data,function(a){return a.id==ids[i]});dataPart.push(pro[0])}dataPart.length>0&&(actualData=dataPart)}$ele.addClass("xm-pro-price").html(getPrice(actualData))})}()}function actions(data){$(document).on("click",".J_openPresalePop",function(event){event.preventDefault(),$(event.target).parents(".modal").modal("hide"),$(".J_presalePop").modal("show")}),$(document).on("click",".J_openColorPop",function(event){event.preventDefault();var $pop=$(".J_colorPop");if($pop.modal("show"),!$pop.html()){var template=doT.template($("#colorPopTempl").html()),tHtml=template(data);$pop.html(tHtml),$pop.find(".J_proList>li").eq(0).click(),"in"==GLOBAL_CONFIG.appLocal.name&&Xiaomi.warehouse.autoWrite()}}),$(document).on("click",".J_colorPop .J_proList>li",function(event){var img=$(this).attr("data-img"),price=$(this).attr("data-price"),name=$(this).attr("data-name"),title=$(this).attr("data-title"),gid=($(this).attr("data-product"),$(this).attr("data-gid")),$pop=$(this).parents(".J_colorPop"),$popTitle=$pop.find(".J_popTitle"),$colorNextBtn=new Buy($pop.find(".J_btnYes").buyButton()),proData=$.grep(data,function(e){return e.id===gid});$pop.find(".J_proThumb").attr({src:img+"?width=220&height=220",alt:title}),$pop.find(".J_proName").text(name),$pop.find(".J_proPrice").text(price),title!==$popTitle.text()&&$popTitle.text(title),$(this).addClass("selected").siblings().removeClass("selected out-of-stock"),$pop.find(".J_proInfo").show(),$pop.find(".J_proStock").hide(),$pop.find(".J_proRegister").hide(),$pop.find(".J_soldBy")&&$pop.find(".J_soldBy").text("Sold by : "+proData[0].goods_dealer),changeBuyBtn($colorNextBtn,proData),generateRemark(proData[0])&&$pop.find(".J_proRegister").text(generateRemark(proData[0])).show(),!proData[0].is_cos||proData[0].is_presale&&!proData[0].presale_cos||($(this).addClass("out-of-stock"),$pop.find(".J_proInfo").hide(),$pop.find(".J_proRegister").hide(),$pop.find(".J_proStock").show())}),$(document).on("click",".J_colorPop .J_btnYes",function(event){$(this).parents(".J_colorPop").modal("hide")}),$(document).on("click",".J_openNotifyPop",function(e){var $pop=$(".J_notifyPop"),$steps=$pop.find(".notifyStep");$pop.attr("data-gid",$(this).attr("data-gid"));var url=xiaomi.globalConfig.orderSite+"/arrivalnotice/watch",gid=$pop.attr("data-gid");$(this).attr("disabled")||(Xiaomi.utils.cookie("cUserId")?isNotify[gid]?($pop.modal("show"),$steps.addClass("hide").filter('[data-type="confirm"]').removeClass("hide")):gid&&(url=url+"?goodsId="+gid,Xiaomi.utils.jsonp({url:url,jsonpCallback:"arrivalnotice",successcallback:function(data){$pop.modal("show"),$steps.addClass("hide").filter('[data-type="confirm"]').removeClass("hide"),isNotify[gid]=!0},errorcallback:function(data){alert(data.errmsg)}})):Xiaomi.utils.login())}),checkbox(".J_presalePop .modal-footer .J_agree",function($target){var $pop=$target.parents(".J_presalePop"),$btnYes=$pop.find(".modal-footer .J_btnYes"),gid=$pop.attr("data-gid"),$presaleNextBtn=new Buy($pop.find(".J_btnYes").buyButton());$btnYes.removeAttr("disabled"),$presaleNextBtn.addToCart(gid+"?source=presales")},function($target){$target.parents(".J_presalePop").find(".modal-footer .J_btnYes").attr("disabled","").removeAttr("href")})}function replaceAll(str,mapObj){var re=new RegExp(Object.keys(mapObj).join("|"),"gi");return str.replace(re,function(matched){return mapObj[matched.toLowerCase()]})}function formatTimestamp(timestamp){var noon,moment=new Date(timestamp),date=moment.getDate(),month=options.dateFormat.monthArray[moment.getMonth()],hours=moment.getHours();return hours>12?(hours-=12,noon=options.dateFormat.pm):noon=12==hours?options.dateFormat.noon:options.dateFormat.am,0==hours&&(hours=12),[date,month,hours,noon]}function generateRemark(productData){var saleTime=formatTimestamp(1e3*productData.pb_start),mapObj={"%d":saleTime[0],"%m":saleTime[1],"%h":saleTime[2],"%n":saleTime[3]},registerText=replaceAll(options.remarkText.register,mapObj),registerOverText=replaceAll(options.remarkText.registerOver,mapObj),saleAtText=replaceAll(options.remarkText.saleAt,mapObj);switch(productData.status){case 2:return registerText;case 3:case 4:return registerOverText;case 13:case 14:return saleAtText;default:return}}function checkbox(selector,enableCb,disableCb){var _tt=this;return this.disable=function($target,cb){return $target.removeAttr("checked"),null!==cb&&"function"==typeof cb&&cb($target),this},this.enable=function($target,cb){return $target.attr("checked",""),null!==cb&&"function"==typeof cb&&cb($target),this},$(document).on("click",selector,function(event){$target=$(this),$target.hasClass("xm-checkbox")&&($(this).attr("checked")?_tt.disable($target,disableCb):_tt.enable($target,enableCb))}),this}var defaultOptions={bespeakUrl:xiaomi.globalConfig.wwwSite+"/hdindex/openbuy/",text:{buy:"Buy now",outOfStock:"Out of Stock",bespeak:"Register",beforeFlashSale:"Coming Soon",init:"Buy now",notify:"Notify me"},dateFormat:{monthArray:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],am:"am",noon:"noon",pm:"pm"},remarkText:{register:"Register for %d %m %h %n sale",registerOver:"Registration over. (Sale at %d %m %h %n )",saleAt:"Sale at %d %m %h %n"}};options=$.extend(!0,{},defaultOptions,options),$.fn.buyButton=function(){return this.disable=function(text){return this.reset(),this.attr("disabled","").removeAttr("href").text(text),this},this.enableUrl=function(href,text){return this.reset(),this.removeAttr("disabled").attr("href",href).text(text),this},this.enableClass=function(flag,text){return this.reset(),this.removeAttr("disabled").addClass(flag).text(text),this},this.reset=function(){this.removeAttr("href data-gid").removeClass("J_openNotifyPop J_openPresalePop J_openColorPop").off("click.buy")},this};var $price=$(".J_xmProPrice");if(btnObj.length>0||$price.length>0){var buyObj=new Buy(btnObj.buyButton()),url=xiaomi.globalConfig.orderSite+"/misc/getStarStock/hdid/"+options.productType;"in"==GLOBAL_CONFIG.appLocal.name&&(url=Xiaomi.warehouse.addAjaxParam(url)),$.ajax({type:"get",url:url,dataType:"jsonp",jsonp:"jsonpcallback",jsonpCallback:"getStarStock",success:function(data){$(".J_goodsDealer").length>0&&data[0]&&$(".J_goodsDealer").text("The "+$(".J_goodsDealer").attr("data-name")+" is sold in India by "+data[0].goods_dealer+", an authorized Indian distributor of Mi products."),$price.length>0&&writePrice(data),btnObj.length>0&&(changeBuyBtn(buyObj,data),actions(data)),"in"===GLOBAL_CONFIG.appLocal.name&&pushTagsForGTM(data),"es"===GLOBAL_CONFIG.appLocal.name&&pushTagsForPixel(data)},errorcallback:function(data){alert(data.errmsg)}})}}}()},function(module,exports,__webpack_require__){module.exports=__webpack_require__(0)}]);